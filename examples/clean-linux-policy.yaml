metadata:
  name: "linux-web-server-policy"
  version: "1.0"
  description: "Security policy for Linux web servers"
  author: "AuditAgent"

zones:
  dmz:
    name: "dmz"
    description: "DMZ for web servers"
    networks:
      - cidr: "192.168.100.0/24"
  
  management:
    name: "management"  
    description: "Management network"
    networks:
      - cidr: "10.0.0.0/24"

firewall_rules:
  - name: "allow-ssh-from-mgmt"
    description: "Allow SSH from management network"
    enabled: true
    priority: 10
    action: "allow"
    direction: "inbound"
    protocol:
      name: "tcp"
      number: 6
    source_zones:
      - name: "management"
    destination_zones:
      - name: "dmz"
    destination_ports:
      - number: 22
    log_traffic: true

  - name: "allow-web-traffic"
    description: "Allow web traffic to DMZ"
    enabled: true
    priority: 100
    action: "allow"
    direction: "inbound"
    protocol:
      name: "tcp"
      number: 6
    source_ips:
      - cidr: "0.0.0.0/0"
    destination_zones:
      - name: "dmz"
    destination_ports:
      - number: 80
      - number: 443
    log_traffic: true

  - name: "deny-all-other"
    description: "Deny all other traffic to DMZ"
    enabled: true
    priority: 1000
    action: "deny"
    direction: "inbound"
    protocol:
      name: "any"
    source_ips:
      - cidr: "0.0.0.0/0"
    destination_zones:
      - name: "dmz"
    log_traffic: true

nat_rules: []
vpn_rules: []
qos_rules: []
global_settings: {}
